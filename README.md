# codebook

Record books about reading refactoring code.


C++
windows + dulib

JS
Vue + vuex + nodejs + c++
前端模块化、工程化、性能优化

实现功能：
Web端：帮助团队完成底层代码重新架构，功能模块重新封装，包括：重构底层数据存储结构，设计接入localStorage、IndexDB、 FileSystem; 重构离线消息模块; 重构消息发送接收模块, 实现MVC模式逻辑与UI分离; 接入RSA, AES消息文件加解密功能; 完善云盘功能，并实现文件分块加密上传下载，断点续传功能; 桌面共享功能实现；UI部分重构封装等，及后续业务功能开发和维护。
Electron客户端:  共同搭建客户端，完善客户端功能：sqlite数据库; C++截图功能接入; 老版本升级功能接入; 静默升级功能实现；
通信平台：通信平台web端基础通信sdk模块封装
优化：界面白屏, 内存泄漏, 性能卡顿, 首屏时间
能够与用户积极交流，对线上BUG问题的进行现场排查，与不同端同步联调，及手机端单独web view引入的H5界面开发

面向过程 -> 面向对象

MVVM -> MVC

V -> M

C -> controler msgManager UserInfoManager

M -> model UserInfo GroupInfo



通用的工具模块封装
数据持久化:
  DB-> 封装为两个模块 数据库表设计啊
文件模块的封装
加密模块的封装
用户信息模块的封装
消息模块的封装
Session模块的封装
消息流程优化 factory -> messageManager  messageEntiy

离线消息优化 offlineMsg

性能优化
  图片的懒加载
  左侧会话列表懒加载
  插入消息优化，webworker
  页面优化，v-show 和v-if
  渲染优化，key值缓存
  UI层优化，减少重排, 统一读取数据, 然后再写数据。
  DOM渲染层优化
  输入框优化
  逻辑优化,

内存优化
  闭包
  事件绑定
  全局变量、计时器
  没有必要的全局变量
  * 解除引用
  * 减少对象的创建, 避免循环使用new对象
  * 内存不是缓存, 大数据量东西, 不是很重要的资源，不要直接放在内存中
  * 避免复杂的递归调用, 堆栈溢出, 复杂且每次调用需要在栈里存储大量信息的时候, 很容易就超过栈空间了
  * 合理使用IndexDb, 定期清理数据，不去无脑写入数据
  * 全局变量、计时器
首屏优化
  减少Html请求，减少包体积，缩小图片体积，延迟加载JS文件，preDNS
  特殊懒加载
  正常流程的首屏加载顺序: HTML文档-> 内连CSS渲染-> Js加载及执行-> 加载第三方的库
  优化后的逻辑: 首屏数据拉取逻辑置于顶部->首屏渲染CSS及JS->次屏逻辑延后处理和执行
  页面切分为模块化加载，对应模块下的CSS交给JS
  js 延迟加载，有需要才去加载
  使用雪碧图
  缓存一切可缓存的资源
  图片 非首屏都采用懒加载模式
  图片、文件等放在同一域名下, 减少DNS解析
  服务端模块化接口的支持
  首屏内容最好做到静态缓存
  避免js中进行不要的DOM读写操作
  配置CDN加快下载速度

通信平台
  MQQT协议上 封装一层连接，会话，创建等等。


#### [！！！this 永远指向最后一个调用它的对象，匿名函数的 this 永远指向 window](https://juejin.im/post/59bfe84351882531b730bac2)

#### [electron 性能优化](https://juejin.im/post/5e0010866fb9a015fd69c645)
